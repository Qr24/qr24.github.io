<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>Gemma через CDN</title>
    <!-- Загружаем Transformers.js через CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.1"></script>
</head>

<body>
    <textarea id="input" placeholder="Введите запрос..." rows="4" cols="50"></textarea><br>
    <button onclick="generate()">Генерировать</button>

    <div id="output"></div>

    <script>
        let pipeline = null;

        async function loadModel() {
            if (!pipeline) {
                console.log("Загрузка модели...");
                // Используем более легкую модель для демонстрации
                pipeline = await transformers.pipeline(
                    'text-generation',
                    'Xenova/gemma-2b-it' // Более легкая версия
                );
                console.log("Модель загружена");
            }
            return pipeline;
        }

        async function generate() {
            const input = document.getElementById('input').value;
            const output = document.getElementById('output');

            output.innerHTML = "Загрузка модели... (может занять время)";

            try {
                const generator = await loadModel();
                output.innerHTML = "Генерация ответа...";

                const result = await generator(input, {
                    max_new_tokens: 50,
                    temperature: 0.7,
                });

                output.innerHTML = result[0].generated_text;

            } catch (error) {
                output.innerHTML = "Ошибка: " + error.message;
                console.error(error);
            }
        }
    </script>
</body>

</html>